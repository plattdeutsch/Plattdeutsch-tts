# Elastic Beanstalk Python Platform Configuration
# Application: plattdeutsch-tts-app
# Environment: Plattdeutsch-tts-app-env
# Region: eu-central-1

option_settings:
  # Python platform settings
  aws:elasticbeanstalk:container:python:
    WSGIPath: backend/application:application
    NumProcesses: 2
    NumThreads: 1
  
  # Environment variables
  aws:elasticbeanstalk:application:environment:
    FLASK_ENV: production
    MODEL_BASE_PATH: /var/app/models
    STATIC_FOLDER: static
    PYTHONUNBUFFERED: "1"
    LOG_LEVEL: info
  
  # Instance configuration
  aws:autoscaling:launchconfiguration:
    InstanceType: t3.medium
    RootVolumeType: gp3
    RootVolumeSize: 30
  
  # Load balancer health check
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /api/health
    HealthCheckInterval: 30
    HealthCheckTimeout: 10
    MatcherHTTPCode: 200
  
  # Auto-scaling settings
  aws:autoscaling:asg:
    MinSize: 1
    MaxSize: 2
  
  # Deployment policy
  aws:elasticbeanstalk:command:
    DeploymentPolicy: Rolling
    BatchSizeType: Percentage
    BatchSize: 50
    Timeout: 600
  
  # CloudWatch logs
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 30
